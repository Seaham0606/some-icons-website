<!doctype html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Some Icons</title>
    <style>
      :root {
        font-family: Inter, system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
        font-size: 14px;
        color: #111;
      }

      * {
        box-sizing: border-box;
      }

      html,
      body {
        width: 100%;
        margin: 0;
        background: #fff;
      }

      /* Header */
      .header {
        padding: 32px 24px;
        text-align: center;
        border-bottom: 1px solid rgba(0, 0, 0, 0.06);
      }

      .header h1 {
        margin: 0 0 8px 0;
        font-size: 32px;
        font-weight: 600;
      }

      .header p {
        margin: 0;
        color: #666;
        font-size: 16px;
      }

      /* App shell */
      .app {
        max-width: 1200px;
        margin: 0 auto;
        min-height: calc(100vh - 200px);
        display: flex;
        flex-direction: column;
      }

      input,
      select {
        width: 100%;
        height: 40px;
        padding: 8px;
        border: 1px solid #ddd;
        border-radius: 10px;
        background: #fff;
        font: inherit;
        font-size: 14px;
      }

      select {
        padding-left: 10px;
      }

      input:focus {
        outline: none;
        border-color: #5DB0FC;
        border-width: 2px;
      }

      select:focus {
        outline: none;
        border-color: #ddd;
        border-width: 1px;
      }

      /* Search field with icon */
      .search-wrapper {
        position: relative;
      }

      .search-wrapper .search-icon {
        position: absolute;
        left: 8px;
        top: 50%;
        transform: translateY(-50%);
        width: 20px;
        height: 20px;
        pointer-events: none;
        z-index: 1;
      }

      .search-wrapper input {
        padding-left: 36px;
      }

      /* Select dropdown with icon */
      .select-wrapper {
        position: relative;
      }

      .select-wrapper .select-icon {
        position: absolute;
        right: 8px;
        top: 50%;
        transform: translateY(-50%);
        width: 24px;
        height: 24px;
        pointer-events: none;
        z-index: 1;
        display: flex;
        align-items: center;
        justify-content: center;
      }

      .select-wrapper select {
        padding-right: 30px;
        appearance: none;
        -webkit-appearance: none;
        -moz-appearance: none;
      }

      /* Top function area */
      .topbar {
        flex-shrink: 0;
        padding: 24px;
        background: #fff;
      }

      .controls {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 8px;
        margin-top: 8px;
      }

      /* Scroll area */
      .content {
        flex: 1;
        display: flex;
        flex-direction: column;
        min-height: 0;
      }

      .grid {
        padding: 0 24px 24px;
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
        gap: 12px;
      }

      /* Icon card */
      .card {
        aspect-ratio: 1 / 1;
        border-radius: 10px;
        background: #fff;
        border: 1px solid rgba(0, 0, 0, 0.06);
        cursor: pointer;
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        user-select: none;
        overflow: hidden;
        transition: all 0.2s;
        position: relative;
      }

      .card:hover {
        background: rgba(0, 0, 0, 0.03);
        border-color: #5DB0FC;
        transform: translateY(-2px);
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
      }

      .iconBox {
        width: 100%;
        height: 100%;
        display: grid;
        place-items: center;
        padding: 16px;
      }

      .iconBox img {
        width: 60%;
        height: 60%;
        object-fit: contain;
        pointer-events: none;
        user-select: none;
      }

      .card-name {
        position: absolute;
        bottom: 0;
        left: 0;
        right: 0;
        padding: 8px;
        background: rgba(255, 255, 255, 0.95);
        font-size: 11px;
        color: #666;
        text-align: center;
        opacity: 0;
        transition: opacity 0.2s;
        border-top: 1px solid rgba(0, 0, 0, 0.06);
      }

      .card:hover .card-name {
        opacity: 1;
      }

      .muted {
        color: #b1b1b1;
        font-size: 12px;
      }

      /* Toast notification */
      .toast {
        position: fixed;
        bottom: 24px;
        left: 50%;
        transform: translateX(-50%);
        background: #111;
        color: #fff;
        padding: 12px 24px;
        border-radius: 8px;
        font-size: 14px;
        opacity: 0;
        pointer-events: none;
        transition: opacity 0.3s;
        z-index: 1000;
      }

      .toast.show {
        opacity: 1;
      }

      /* Footer */
      .footer {
        padding: 24px;
        border-top: 1px solid rgba(0, 0, 0, 0.06);
        margin-top: auto;
        flex-shrink: 0;
        text-align: center;
      }

      .footer-content {
        font-size: 14px;
        color: #777;
      }

      .footer-content a {
        color: #5DB0FC;
        text-decoration: none;
        cursor: pointer;
      }

      .footer-content a:hover {
        text-decoration: underline;
      }

      @media (max-width: 768px) {
        .grid {
          grid-template-columns: repeat(auto-fill, minmax(80px, 1fr));
          gap: 8px;
          padding: 0 16px 16px;
        }

        .header {
          padding: 24px 16px;
        }

        .header h1 {
          font-size: 24px;
        }

        .topbar {
          padding: 16px;
        }
      }
    </style>
  </head>

  <body>
    <div class="header">
      <h1>Some Icons</h1>
      <p>A clean, lightweight outline icon set designed for modern interfaces</p>
    </div>

    <div class="app">
      <div class="topbar">
        <div class="search-wrapper">
          <div class="search-icon" id="search-icon"></div>
          <input id="search" placeholder="Search icons" />
        </div>

        <div class="controls">
          <div class="select-wrapper">
            <select id="style">
              <option value="outline" selected>Outline</option>
              <option value="filled">Filled</option>
            </select>
            <div class="select-icon" id="style-icon"></div>
          </div>

          <div class="select-wrapper">
            <select id="category">
              <option value="all">All icons</option>
            </select>
            <div class="select-icon" id="category-icon"></div>
          </div>
        </div>
      </div>

      <div class="content">
        <div id="grid" class="grid"></div>
      </div>
    </div>

    <div class="toast" id="toast"></div>

    <footer class="footer">
      <div class="footer-content" id="footer-content"></div>
    </footer>

    <script>
      const BASE_URL = "https://raw.githubusercontent.com/Seaham0606/some-icons-cdn/main/";

      let ICONS = [];

      const elSearch = document.getElementById("search");
      const elStyle = document.getElementById("style");
      const elCategory = document.getElementById("category");
      const elGrid = document.getElementById("grid");
      const elToast = document.getElementById("toast");

      const svgCache = new Map();

      function uniq(arr) {
        return Array.from(new Set(arr)).sort();
      }

      function showToast(message) {
        elToast.textContent = message;
        elToast.classList.add("show");
        setTimeout(() => elToast.classList.remove("show"), 2000);
      }

      async function loadIndex() {
        const res = await fetch(`${BASE_URL}index.json`, { cache: "no-store" });
        const data = await res.json();
        ICONS = data.icons || [];
      }

      function buildCategories() {
        elCategory.innerHTML = `<option value="all">All icons</option>`;
        const cats = uniq(ICONS.map((i) => i.category).filter(Boolean));
        
        const sortedCats = [...cats];
        const generalIndex = sortedCats.indexOf("general");
        if (generalIndex > -1) {
          sortedCats.splice(generalIndex, 1);
          sortedCats.unshift("general");
        }
        
        sortedCats.forEach((c) => {
          const opt = document.createElement("option");
          opt.value = c;
          opt.textContent = c.charAt(0).toUpperCase() + c.slice(1);
          elCategory.appendChild(opt);
        });
      }

      function normalizeQuery(s) {
        return (s || "").trim().toLowerCase();
      }

      function matches(icon, q) {
        if (!q) return true;
        return `${icon.id} ${icon.category} ${(icon.tags || []).join(" ")}`
          .toLowerCase()
          .includes(q);
      }

      async function fetchSvgText(icon, style) {
        const relPath = icon.files?.[style];
        const key = `${style}:${relPath}`;
        if (svgCache.has(key)) return svgCache.get(key);

        const res = await fetch(`${BASE_URL}${relPath}`, { cache: "no-store" });
        const text = await res.text();
        svgCache.set(key, text);
        return text;
      }

      async function loadUIIcon(iconId, containerId, style = "outline") {
        const icon = ICONS.find((i) => i.id === iconId);
        if (!icon || !icon.files?.[style]) return;

        const svg = await fetchSvgText(icon, style);
        let s = svg;
        if (!/\bviewBox=/i.test(s)) {
          s = s.replace(/<svg/i, '<svg viewBox="0 0 16 16"');
        }
        s = s.replaceAll("currentColor", "#000000");
        const encoded = encodeURIComponent(s)
          .replace(/'/g, "%27")
          .replace(/"/g, "%22");
        
        const container = document.getElementById(containerId);
        if (container) {
          container.innerHTML = "";
          const img = document.createElement("img");
          img.src = `data:image/svg+xml,${encoded}`;
          img.style.width = "100%";
          img.style.height = "100%";
          img.style.objectFit = "contain";
          img.style.opacity = "0.3";
          container.appendChild(img);
        }
      }

      async function loadUIIcons() {
        await loadUIIcon("general-search", "search-icon", "filled");
        await loadUIIcon("arrow-down-triangle", "style-icon", "filled");
        await loadUIIcon("arrow-down-triangle", "category-icon", "filled");
      }

      function copyToClipboard(text) {
        navigator.clipboard.writeText(text).then(() => {
          showToast("SVG copied to clipboard!");
        }).catch(() => {
          showToast("Failed to copy");
        });
      }

      function initFooter() {
        const year = new Date().getFullYear();
        const footerContent = document.getElementById("footer-content");
        if (footerContent) {
          footerContent.innerHTML = `© ${year} Sihan Liu · <a href="https://github.com/Seaham0606/some-icons-cdn" target="_blank">GitHub</a> · <a href="https://choosealicense.com/licenses/mit/" target="_blank">MIT License</a>`;
        }
      }

      function render() {
        const q = normalizeQuery(elSearch.value);

        const filtered = ICONS.filter((icon) => {
          if (!q && elCategory.value !== "all" && icon.category !== elCategory.value)
            return false;
          if (!icon.files?.[elStyle.value])
            return false;
          return matches(icon, q);
        });

        elGrid.innerHTML = "";

        filtered.forEach((icon) => {
          const style = elStyle.value;
          const card = document.createElement("div");
          card.className = "card";
          card.title = icon.id;

          const box = document.createElement("div");
          box.className = "iconBox";
          box.innerHTML = `<span class="muted">…</span>`;
          card.appendChild(box);

          const name = document.createElement("div");
          name.className = "card-name";
          name.textContent = icon.id;
          card.appendChild(name);

          (async () => {
            const svg = await fetchSvgText(icon, style);
            let s = svg;
            if (!/\bviewBox=/i.test(s)) {
              s = s.replace(/<svg/i, '<svg viewBox="0 0 16 16"');
            }
            s = s.replaceAll("currentColor", "#111");
            const encoded = encodeURIComponent(s)
              .replace(/'/g, "%27")
              .replace(/"/g, "%22");
            const img = document.createElement("img");
            img.src = `data:image/svg+xml,${encoded}`;
            box.innerHTML = "";
            box.appendChild(img);
          })();

          card.onclick = async () => {
            const svg = await fetchSvgText(icon, style);
            copyToClipboard(svg);
          };

          elGrid.appendChild(card);
        });
      }

      elSearch.oninput = render;
      elStyle.onchange = render;
      elCategory.onchange = render;

      (async () => {
        await loadIndex();
        buildCategories();
        await loadUIIcons();
        initFooter();
        render();
      })();
    </script>
  </body>
</html>